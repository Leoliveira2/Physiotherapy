import React, { useState, useEffect } from ‘react’;
import { Calendar, Save, User, Activity, AlertTriangle, Clock, Search, CheckCircle, XCircle, Home, UserPlus, List, Eye, FileText, Users } from ‘lucide-react’;

const FisioterapiaApp = () => {
// Estados principais
const [pacientes, setPacientes] = useState({});
const [quartoSelecionado, setQuartoSelecionado] = useState(’’);
const [pacienteAtual, setPacienteAtual] = useState(null);
const [modoNovoRegistro, setModoNovoRegistro] = useState(false);
const [telaAtiva, setTelaAtiva] = useState(‘principal’);
const [loading, setLoading] = useState(false);

// Estado do formulário
const [dadosForm, setDadosForm] = useState({
dataAvaliacao: new Date().toISOString().split(‘T’)[0],
horaAvaliacao: new Date().toTimeString().split(’ ’)[0].slice(0, 5),
escalaMobilidade: ‘’,
ventilacao: ‘’,
observacoes: ‘’,
complexidade: ‘’,
restricaoLeito: ‘Não’,
altoRiscoQueda: ‘Não’,
dispositivos1a2: ‘Não’,
dispositivos3mais: ‘Não’,
social: ‘Não’,
mobilizacaoDevice: ‘Não’,
necessidadeO2: ‘Não’
});

const [pontuacao, setPontuacao] = useState(0);

// Função para carregar dados do storage
const carregarDados = () => {
try {
const dadosSalvos = localStorage.getItem(‘fisioterapia_pacientes’);
if (dadosSalvos) {
const dados = JSON.parse(dadosSalvos);
setPacientes(dados);
console.log(‘Dados carregados:’, Object.keys(dados).length, ‘pacientes’);
}
} catch (error) {
console.error(‘Erro ao carregar dados:’, error);
setPacientes({});
}
};

// Função para salvar dados no storage
const salvarDados = (novosDados) => {
try {
localStorage.setItem(‘fisioterapia_pacientes’, JSON.stringify(novosDados));
console.log(‘Dados salvos com sucesso’);
} catch (error) {
console.error(‘Erro ao salvar dados:’, error);
alert(‘Erro ao salvar dados. Verifique o espaço de armazenamento do navegador.’);
}
};

// Carregar dados na inicialização
useEffect(() => {
carregarDados();
}, []);

// Calcular pontuação automaticamente
useEffect(() => {
let total = 0;

```
if (dadosForm.complexidade === 'Baixa') total += 1;
else if (dadosForm.complexidade === 'Média') total += 2;
else if (dadosForm.complexidade === 'Alta') total += 3;

if (dadosForm.restricaoLeito === 'Sim') total += 1;
if (dadosForm.altoRiscoQueda === 'Sim') total += 1;
if (dadosForm.dispositivos1a2 === 'Sim') total += 2;
if (dadosForm.dispositivos3mais === 'Sim') total += 3;
if (dadosForm.social === 'Sim') total += 3;
if (dadosForm.mobilizacaoDevice === 'Sim') total += 4;
if (dadosForm.necessidadeO2 === 'Sim') total += 5;

setPontuacao(total);
```

}, [dadosForm]);

// Buscar paciente por quarto
const buscarPacientePorQuarto = (numeroQuarto) => {
if (!numeroQuarto) {
alert(‘Digite um número de quarto’);
return;
}

```
const paciente = pacientes[numeroQuarto];
if (paciente && !paciente.altaMedica) {
  setPacienteAtual(paciente);
  setModoNovoRegistro(false);
  console.log('Paciente encontrado:', paciente);
} else {
  setPacienteAtual(null);
  setModoNovoRegistro(true);
  console.log('Quarto disponível para novo paciente');
}
```

};

// Criar novo paciente
const criarNovoPaciente = (dadosPaciente) => {
setLoading(true);
console.log(‘Criando novo paciente:’, dadosPaciente);

```
try {
  const novoPaciente = {
    id: Date.now(),
    quarto: quartoSelecionado,
    ...dadosPaciente,
    dataInternacao: new Date().toISOString().split('T')[0],
    altaMedica: false,
    avaliacoes: []
  };
  
  const novosPacientes = {
    ...pacientes,
    [quartoSelecionado]: novoPaciente
  };
  
  setPacientes(novosPacientes);
  salvarDados(novosPacientes);
  setPacienteAtual(novoPaciente);
  setModoNovoRegistro(false);
  
  alert('Paciente cadastrado com sucesso!');
} catch (error) {
  console.error('Erro ao criar paciente:', error);
  alert('Erro ao cadastrar paciente. Tente novamente.');
} finally {
  setLoading(false);
}
```

};

// Salvar avaliação
const salvarAvaliacao = () => {
if (!pacienteAtual) {
alert(‘Erro: Nenhum paciente selecionado’);
return;
}

```
const novaAvaliacao = {
  id: Date.now(),
  ...dadosForm,
  pontuacaoTotal: pontuacao,
  dataRegistro: new Date().toISOString()
};

const pacienteAtualizado = {
  ...pacienteAtual,
  avaliacoes: [...(pacienteAtual.avaliacoes || []), novaAvaliacao]
};

const novosPacientes = {
  ...pacientes,
  [pacienteAtual.quarto]: pacienteAtualizado
};

setPacientes(novosPacientes);
salvarDados(novosPacientes);
setPacienteAtual(pacienteAtualizado);

// Limpar formulário
setDadosForm({
  dataAvaliacao: new Date().toISOString().split('T')[0],
  horaAvaliacao: new Date().toTimeString().split(' ')[0].slice(0, 5),
  escalaMobilidade: '',
  ventilacao: '',
  observacoes: '',
  complexidade: '',
  restricaoLeito: 'Não',
  altoRiscoQueda: 'Não',
  dispositivos1a2: 'Não',
  dispositivos3mais: 'Não',
  social: 'Não',
  mobilizacaoDevice: 'Não',
  necessidadeO2: 'Não'
});

alert('Avaliação salva com sucesso!');
```

};

// Dar alta médica
const darAltaMedica = () => {
if (!pacienteAtual) return;

```
const pacienteComAlta = {
  ...pacienteAtual,
  altaMedica: true,
  dataAlta: new Date().toISOString().split('T')[0]
};

const novosPacientes = {
  ...pacientes,
  [pacienteAtual.quarto]: pacienteComAlta
};

setPacientes(novosPacientes);
salvarDados(novosPacientes);
setPacienteAtual(null);
setModoNovoRegistro(true);

alert('Alta médica registrada com sucesso!');
```

};

// Visualizar paciente específico
const visualizarPaciente = (quarto) => {
setQuartoSelecionado(quarto);
const paciente = pacientes[quarto];
setPacienteAtual(paciente);
setModoNovoRegistro(false);
setTelaAtiva(‘principal’);
};

const handleInputChange = (field, value) => {
setDadosForm(prev => ({
…prev,
[field]: value
}));
};

const getComplexidadeColor = () => {
switch(dadosForm.complexidade) {
case ‘Baixa’: return ‘text-green-600 bg-green-50 border-green-200’;
case ‘Média’: return ‘text-yellow-600 bg-yellow-50 border-yellow-200’;
case ‘Alta’: return ‘text-red-600 bg-red-50 border-red-200’;
default: return ‘text-gray-600 bg-gray-50 border-gray-200’;
}
};

// Tela de consulta de registros
if (telaAtiva === ‘consulta’) {
return (
<TelaConsulta
pacientes={pacientes}
onVoltar={() => setTelaAtiva(‘principal’)}
onVisualizarPaciente={visualizarPaciente}
/>
);
}

return (
<div className="max-w-6xl mx-auto p-6 bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
{/* Header com navegação */}
<div className="bg-white rounded-xl shadow-lg p-6 mb-6">
<div className="flex justify-between items-center">
<div>
<h1 className="text-3xl font-bold text-gray-900 flex items-center gap-3">
<Activity className="text-blue-600" size={36} />
Sistema de Registro de Pacientes - Fisioterapia
</h1>
<p className="text-gray-600 mt-2">Gestão inteligente por quarto com histórico completo</p>
</div>
<button
onClick={() => setTelaAtiva(‘consulta’)}
className=“bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg flex items-center gap-2 transition-colors”
>
<Users size={20} />
Consultar Registros
</button>
</div>
</div>

```
  {/* Busca por Quarto */}
  <div className="bg-white rounded-xl shadow-lg p-6 mb-6">
    <div className="flex items-center gap-4">
      <div className="flex-1">
        <label className="block text-sm font-medium text-gray-700 mb-2">
          Número do Quarto
        </label>
        <div className="flex gap-3">
          <input
            type="text"
            value={quartoSelecionado}
            onChange={(e) => setQuartoSelecionado(e.target.value)}
            className="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg"
            placeholder="Ex: 520"
          />
          <button
            onClick={() => buscarPacientePorQuarto(quartoSelecionado)}
            className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg flex items-center gap-2 transition-colors"
          >
            <Search size={20} />
            Buscar
          </button>
        </div>
      </div>
    </div>

    {/* Status do Quarto */}
    {quartoSelecionado && (
      <div className="mt-4">
        {pacienteAtual && !pacienteAtual.altaMedica ? (
          <div className="bg-green-50 border border-green-200 rounded-lg p-4">
            <div className="flex items-center justify-between">
              <div>
                <h3 className="text-lg font-semibold text-green-800">{pacienteAtual.nomeCompleto}</h3>
                <p className="text-green-600">Internado desde: {new Date(pacienteAtual.dataInternacao).toLocaleDateString('pt-BR')}</p>
                <p className="text-green-600">Avaliações: {pacienteAtual.avaliacoes?.length || 0}</p>
              </div>
              <button
                onClick={darAltaMedica}
                className="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors"
              >
                <Home size={16} />
                Alta Médica
              </button>
            </div>
          </div>
        ) : modoNovoRegistro ? (
          <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
            <div className="flex items-center gap-2">
              <UserPlus className="text-blue-600" size={20} />
              <span className="text-blue-800 font-medium">Quarto disponível - Cadastrar novo paciente</span>
            </div>
          </div>
        ) : (
          <div className="bg-gray-50 border border-gray-200 rounded-lg p-4">
            <span className="text-gray-600">Digite um número de quarto para continuar</span>
          </div>
        )}
      </div>
    )}
  </div>

  {/* Formulário de Novo Paciente */}
  {modoNovoRegistro && quartoSelecionado && (
    <NovoPacienteForm 
      quarto={quartoSelecionado} 
      onCriarPaciente={criarNovoPaciente}
      loading={loading}
    />
  )}

  {/* Formulário de Avaliação */}
  {pacienteAtual && !pacienteAtual.altaMedica && (
    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
      {/* Coluna Principal - Avaliação */}
      <div className="lg:col-span-2 space-y-6">
        <AvaliacaoForm 
          dadosForm={dadosForm}
          handleInputChange={handleInputChange}
          getComplexidadeColor={getComplexidadeColor}
        />
      </div>

      {/* Coluna Lateral - Critérios */}
      <div className="space-y-6">
        <CriteriosAvaliacao 
          dadosForm={dadosForm}
          handleInputChange={handleInputChange}
          pontuacao={pontuacao}
          onSalvar={salvarAvaliacao}
        />
      </div>
    </div>
  )}

  {/* Histórico de Avaliações */}
  {pacienteAtual && pacienteAtual.avaliacoes?.length > 0 && (
    <HistoricoAvaliacoes avaliacoes={pacienteAtual.avaliacoes} />
  )}
</div>
```

);
};

// Componente para novo paciente
const NovoPacienteForm = ({ quarto, onCriarPaciente, loading }) => {
const [dadosPaciente, setDadosPaciente] = useState({
nomeCompleto: ‘’,
dataNascimento: ‘’,
registro: ‘’,
medicoAssistente: ‘’,
diagnostico: ‘’
});

const handleSubmit = (e) => {
e.preventDefault();

```
if (!dadosPaciente.nomeCompleto.trim()) {
  alert('Nome completo é obrigatório');
  return;
}

if (!dadosPaciente.diagnostico.trim()) {
  alert('Diagnóstico é obrigatório');
  return;
}

console.log('Submetendo formulário com dados:', dadosPaciente);
onCriarPaciente(dadosPaciente);
```

};

const handleChange = (field, value) => {
setDadosPaciente(prev => ({
…prev,
[field]: value
}));
};

return (
<div className="bg-white rounded-xl shadow-lg p-6 mb-6">
<h2 className="text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2">
<UserPlus className="text-blue-600" />
Cadastrar Novo Paciente - Quarto {quarto}
</h2>

```
  <form onSubmit={handleSubmit} className="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div className="md:col-span-2">
      <label className="block text-sm font-medium text-gray-700 mb-1">
        Nome Completo *
      </label>
      <input
        type="text"
        value={dadosPaciente.nomeCompleto}
        onChange={(e) => handleChange('nomeCompleto', e.target.value)}
        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
        placeholder="Digite o nome completo do paciente"
        required
        disabled={loading}
      />
    </div>
    
    <div>
      <label className="block text-sm font-medium text-gray-700 mb-1">
        Data de Nascimento
      </label>
      <input
        type="date"
        value={dadosPaciente.dataNascimento}
        onChange={(e) => handleChange('dataNascimento', e.target.value)}
        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
        disabled={loading}
      />
    </div>
    
    <div>
      <label className="block text-sm font-medium text-gray-700 mb-1">
        Registro
      </label>
      <input
        type="text"
        value={dadosPaciente.registro}
        onChange={(e) => handleChange('registro', e.target.value)}
        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
        placeholder="Número do registro"
        disabled={loading}
      />
    </div>
    
    <div>
      <label className="block text-sm font-medium text-gray-700 mb-1">
        Médico Assistente
      </label>
      <input
        type="text"
        value={dadosPaciente.medicoAssistente}
        onChange={(e) => handleChange('medicoAssistente', e.target.value)}
        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
        placeholder="Nome do médico responsável"
        disabled={loading}
      />
    </div>
    
    <div className="md:col-span-2">
      <label className="block text-sm font-medium text-gray-700 mb-1">
        Diagnóstico *
      </label>
      <textarea
        value={dadosPaciente.diagnostico}
        onChange={(e) => handleChange('diagnostico', e.target.value)}
        rows={2}
        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
        placeholder="Diagnóstico principal do paciente"
        required
        disabled={loading}
      />
    </div>
    
    <div className="md:col-span-2">
      <button
        type="submit"
        disabled={loading}
        className={`w-full font-semibold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 ${
          loading 
            ? 'bg-gray-400 cursor-not-allowed text-gray-600' 
            : 'bg-green-600 hover:bg-green-700 text-white'
        }`}
      >
        <UserPlus size={20} />
        {loading ? 'Cadastrando...' : 'Cadastrar Paciente'}
      </button>
    </div>
  </form>
</div>
```

);
};

// Componente do formulário de avaliação
const AvaliacaoForm = ({ dadosForm, handleInputChange, getComplexidadeColor }) => (

  <div className="bg-white rounded-xl shadow-lg p-6">
    <h2 className="text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2">
      <Activity className="text-green-600" />
      Nova Avaliação Fisioterapêutica
    </h2>

```
<div className="grid grid-cols-2 gap-4 mb-6">
  <div>
    <label className="block text-sm font-medium text-gray-700 mb-1">
      Data da Avaliação
    </label>
    <input
      type="date"
      value={dadosForm.dataAvaliacao}
      onChange={(e) => handleInputChange('dataAvaliacao', e.target.value)}
      className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
  </div>
  <div>
    <label className="block text-sm font-medium text-gray-700 mb-1">
      Hora da Avaliação
    </label>
    <input
      type="time"
      value={dadosForm.horaAvaliacao}
      onChange={(e) => handleInputChange('horaAvaliacao', e.target.value)}
      className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
  </div>
</div>

<div className="grid grid-cols-2 gap-4 mb-4">
  <div>
    <label className="block text-sm font-medium text-gray-700 mb-1">
      Escala de Mobilidade (JH)
    </label>
    <select
      value={dadosForm.escalaMobilidade}
      onChange={(e) => handleInputChange('escalaMobilidade', e.target.value)}
      className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
    >
      <option value="">Selecione</option>
      <option value="1">1 - Totalmente dependente</option>
      <option value="2">2 - Dependente com ajuda</option>
      <option value="3">3 - Parcialmente independente</option>
      <option value="4">4 - Independente</option>
    </select>
  </div>
  <div>
    <label className="block text-sm font-medium text-gray-700 mb-1">
      Complexidade
    </label>
    <select
      value={dadosForm.complexidade}
      onChange={(e) => handleInputChange('complexidade', e.target.value)}
      className={`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${getComplexidadeColor()}`}
    >
      <option value="">Selecione</option>
      <option value="Baixa">Baixa</option>
      <option value="Média">Média</option>
      <option value="Alta">Alta</option>
    </select>
  </div>
</div>

<div className="mb-4">
  <label className="block text-sm font-medium text-gray-700 mb-1">
    Ventilação/Suporte Respiratório
  </label>
  <textarea
    value={dadosForm.ventilacao}
    onChange={(e) => handleInputChange('ventilacao', e.target.value)}
    rows={3}
    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
    placeholder="Ex: VNI 2X60' (M/N), CN 1L/MIN, AA (Ar Ambiente)"
  />
</div>

<div>
  <label className="block text-sm font-medium text-gray-700 mb-1">
    Observações da Avaliação
  </label>
  <textarea
    value={dadosForm.observacoes}
    onChange={(e) => handleInputChange('observacoes', e.target.value)}
    rows={4}
    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
    placeholder="Observações sobre a sessão de fisioterapia, evolução, condutas..."
  />
</div>
```

  </div>
);

// Componente dos critérios de avaliação
const CriteriosAvaliacao = ({ dadosForm, handleInputChange, pontuacao, onSalvar }) => {
const criterios = [
{ key: ‘restricaoLeito’, label: ‘Restrito ao Leito’, icon: ‘🛏️’, pontos: 1 },
{ key: ‘altoRiscoQueda’, label: ‘Alto Risco de Queda’, icon: ‘⚠️’, pontos: 1 },
{ key: ‘dispositivos1a2’, label: ‘1 a 2 Dispositivos’, icon: ‘🔌’, pontos: 2 },
{ key: ‘dispositivos3mais’, label: ‘3+ Dispositivos’, icon: ‘🔌’, pontos: 3 },
{ key: ‘social’, label: ‘Questão Social’, icon: ‘👥’, pontos: 3 },
{ key: ‘mobilizacaoDevice’, label: ‘Mobilização c/ Device’, icon: ‘🦽’, pontos: 4 },
{ key: ‘necessidadeO2’, label: ‘Necessidade de O₂/DVA’, icon: ‘💨’, pontos: 5 }
];

return (
<div className="space-y-6">
{/* Critérios */}
<div className="bg-white rounded-xl shadow-lg p-6">
<h2 className="text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2">
<AlertTriangle className="text-yellow-600" />
Critérios de Avaliação
</h2>

```
    <div className="space-y-4">
      {criterios.map((criterio) => (
        <div key={criterio.key} className="bg-gradient-to-r from-gray-50 to-gray-100 p-4 rounded-lg">
          <div className="flex items-center justify-between mb-3">
            <div className="flex items-center gap-2">
              <span className="text-2xl">{criterio.icon}</span>
              <span className="font-medium text-gray-800">{criterio.label}</span>
            </div>
            <span className="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">
              +{criterio.pontos} pts
            </span>
          </div>
          
          <div className="flex gap-3">
            <button
              onClick={() => handleInputChange(criterio.key, 'Sim')}
              className={`flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-lg font-medium transition-all ${
                dadosForm[criterio.key] === 'Sim' 
                  ? 'bg-green-500 text-white shadow-lg transform scale-105' 
                  : 'bg-white text-gray-600 border border-gray-300 hover:bg-green-50'
              }`}
            >
              <CheckCircle size={16} />
              Sim
            </button>
            <button
              onClick={() => handleInputChange(criterio.key, 'Não')}
              className={`flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-lg font-medium transition-all ${
                dadosForm[criterio.key] === 'Não' 
                  ? 'bg-red-500 text-white shadow-lg transform scale-105' 
                  : 'bg-white text-gray-600 border border-gray-300 hover:bg-red-50'
              }`}
            >
              <XCircle size={16} />
              Não
            </button>
          </div>
        </div>
      ))}
    </div>
  </div>

  {/* Pontuação Total */}
  <div className="bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl shadow-lg p-6 text-white text-center">
    <h3 className="text-xl font-semibold mb-4">Pontuação Total</h3>
    <div className="text-6xl font-bold mb-2">
      {pontuacao}
    </div>
    <div className="bg-white bg-opacity-20 rounded-lg p-3">
      <p className="font-medium">
        {pontuacao >= 15 ? '🔴 Alta Complexidade' : 
         pontuacao >= 10 ? '🟡 Média Complexidade' : 
         '🟢 Baixa Complexidade'}
      </p>
    </div>
  </div>

  {/* Botão Salvar */}
  <button
    onClick={onSalvar}
    className="w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center justify-center gap-2"
  >
    <Save size={20} />
    Salvar Avaliação
  </button>
</div>
```

);
};

// Componente do histórico
const HistoricoAvaliacoes = ({ avaliacoes }) => (

  <div className="bg-white rounded-xl shadow-lg p-6 mt-6">
    <h2 className="text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2">
      <Clock className="text-purple-600" />
      Histórico de Avaliações ({avaliacoes.length})
    </h2>

```
<div className="space-y-3">
  {avaliacoes.slice(-5).reverse().map((avaliacao, index) => (
    <div key={avaliacao.id} className="bg-gray-50 p-4 rounded-lg border-l-4 border-blue-500">
      <div className="flex justify-between items-start">
        <div>
          <p className="font-medium">
            {new Date(avaliacao.dataAvaliacao).toLocaleDateString('pt-BR')} às {avaliacao.horaAvaliacao}
          </p>
          <p className="text-sm text-gray-600">
            Pontuação: {avaliacao.pontuacaoTotal} | Complexidade: {avaliacao.complexidade}
          </p>
          {avaliacao.observacoes && (
            <p className="text-sm text-gray-600 mt-1 italic">
              "{avaliacao.observacoes.substring(0, 100)}{avaliacao.observacoes.length > 100 ? '...' : ''}"
            </p>
          )}
        </div>
        <span className="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded-full">
          #{avaliacoes.length - index}
        </span>
      </div>
    </div>
  ))}
</div>
```

  </div>
);

// Tela de consulta de registros
const TelaConsulta = ({ pacientes, onVoltar, onVisualizarPaciente }) => {
const [filtro, setFiltro] = useState(‘todos’);
const [busca, setBusca] = useState(’’);

const pacientesArray = Object.values(pacientes);

const pacientesFiltrados = pacientesArray.filter(paciente => {
const matchFiltro = filtro === ‘todos’ ||
(filtro === ‘internados’ && !paciente.altaMedica) ||
(filtro === ‘alta’ && paciente.altaMedica);

```
const matchBusca = !busca || 
                  paciente.nomeCompleto?.toLowerCase().includes(busca.toLowerCase()) ||
                  paciente.quarto?.toString().includes(busca) ||
                  paciente.diagnostico?.toLowerCase().includes(busca.toLowerCase());

return matchFiltro && matchBusca;
```

});

return (
<div className="max-w-6xl mx-auto p-6 bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
{/* Header */}
<div className="bg-white rounded-xl shadow-lg p-6 mb-6">
<div className="flex justify-between items-center">
<div>
<h1 className="text-3xl font-bold text-gray-900 flex items-center gap-3">
<Users className="text-green-600" size={36} />
Consulta de Registros
</h1>
<p className="text-gray-600 mt-2">Visualize todos os pacientes e seus registros</p>
</div>
<button
onClick={onVoltar}
className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg flex items-center gap-2 transition-colors"
>
<Activity size={20} />
Voltar ao Sistema
</button>
</div>
</div>

```
  {/* Filtros e Busca */}
  <div className="bg-white rounded-xl shadow-lg p-6 mb-6">
    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label className="block text-sm font-medium text-gray-700 mb-2">
          Filtrar por Status
        </label>
        <select
          value={filtro}
          onChange={(e) => setFiltro(e.target.value)}
          className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
        >
          <option value="todos">Todos os Pacientes</option>
          <option value="internados">Pacientes Internados</option>
          <option value="alta">Pacientes com Alta</option>
        </select>
      </div>
      
      <div>
        <label className="block text-sm font-medium text-gray-700 mb-2">
          Buscar
        </label>
        <input
          type="text"
          value={busca}
          onChange={(e) => setBusca(e.target.value)}
          className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          placeholder="Nome, quarto ou diagnóstico..."
        />
      </div>
    </div>
  </div>

  {/* Estatísticas */}
  <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
    <div className="bg-white rounded-xl shadow-lg p-6">
      <div className="flex items-center gap-4">
        <div className="bg-blue-100 p-3 rounded-full">
          <Users className="text-blue-600" size={24} />
        </div>
        <div>
          <h3 className="text-2xl font-bold text-gray-900">{pacientesArray.length}</h3>
          <p className="text-gray-600">Total de Pacientes</p>
        </div>
      </div>
    </div>
    
    <div className="bg-white rounded-xl shadow-lg p-6">
      <div className="flex items-center gap-4">
        <div className="bg-green-100 p-3 rounded-full">
          <Activity className="text-green-600" size={24} />
        </div>
        <div>
          <h3 className="text-2xl font-bold text-gray-900">
            {pacientesArray.filter(p => !p.altaMedica).length}
          </h3>
          <p className="text-gray-600">Pacientes Internados</p>
        </div>
      </div>
    </div>
    
    <div className="bg-white rounded-xl shadow-lg p-6">
      <div className="flex items-center gap-4">
        <div className="bg-purple-100 p-3 rounded-full">
          <FileText className="text-purple-600" size={24} />
        </div>
        <div>
          <h3 className="text-2xl font-bold text-gray-900">
            {pacientesArray.reduce((total, p) => total + (p.avaliacoes?.length || 0), 0)}
          </h3>
          <p className="text-gray-600">Total de Avaliações</p>
        </div>
      </div>
    </div>
  </div>

  {/* Lista de Pacientes */}
  <div className="bg-white rounded-xl shadow-lg p-6">
    <h2 className="text-xl font-semibold text-gray-900 mb-4">
      Pacientes Encontrados ({pacientesFiltrados.length})
    </h2>
    
    {pacientesFiltrados.length === 0 ? (
      <div className="text-center py-8">
        <p className="text-gray-500">Nenhum paciente encontrado com os critérios selecionados</p>
      </div>
    ) : (
      <div className="space-y-4">
        {pacientesFiltrados.map((paciente) => (
          <div key={paciente.id} className="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors">
            <div className="flex justify-between items-start">
              <div className="flex-1">
                <div className="flex items-center gap-3 mb-2">
                  <span className="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm font-medium">
                    Quarto {paciente.quarto}
                  </span>
                  {paciente.altaMedica ? (
                    <span className="bg-red-100 text-red-800 px-2 py-1 rounded-full text-sm">
                      Alta em {new Date(paciente.dataAlta).toLocaleDateString('pt-BR')}
                    </span>
                  ) : (
                    <span className="bg-green-100 text-green-800 px-2 py-1 rounded-full text-sm">
                      Internado
                    </span>
                  )}
                </div>
                
                <h3 className="text-lg font-semibold text-gray-900 mb-1">
                  {paciente.nomeCompleto}
                </h3>
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600">
                  <p><strong>Diagnóstico:</strong> {paciente.diagnostico}</p>
                  <p><strong>Médico:</strong> {paciente.medicoAssistente || 'Não informado'}</p>
                  <p><strong>Data Internação:</strong> {new Date(paciente.dataInternacao).toLocaleDateString('pt-BR')}</p>
                  <p><strong>Avaliações:</strong> {paciente.avaliacoes?.length || 0}</p>
                </div>
              </div>
              
              <button
                onClick={() => onVisualizarPaciente(paciente.quarto)}
                className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ml-4"
              >
                <Eye size={16} />
                Visualizar
              </button>
            </div>
          </div>
        ))}
      </div>
    )}
  </div>
</div>
```

);
};

export default FisioterapiaApp;
